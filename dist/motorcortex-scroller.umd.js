!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("@donkeyclip/motorcortex")):"function"==typeof define&&define.amd?define(["@donkeyclip/motorcortex"],e):(t="undefined"!=typeof globalThis?globalThis:t||self)["@donkeyclip/motorcortex-scroller"]=e(t.MotorCortex)}(this,(function(t){"use strict";function e(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var n=e(t);function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},s=function(t){return t&&t.Math==Math&&t},a=s("object"==typeof globalThis&&globalThis)||s("object"==typeof window&&window)||s("object"==typeof self&&self)||s("object"==typeof o&&o)||function(){return this}()||Function("return this")(),u={},c=function(t){try{return!!t()}catch(t){return!0}},l=!c((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]})),f=Function.prototype.call,h=f.bind?f.bind(f):function(){return f.apply(f,arguments)},p={},d={}.propertyIsEnumerable,v=Object.getOwnPropertyDescriptor,g=v&&!d.call({1:2},1);p.f=g?function(t){var e=v(this,t);return!!e&&e.enumerable}:d;var y,b,m=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}},w=Function.prototype,S=w.bind,T=w.call,j=S&&S.bind(T),O=S?function(t){return t&&j(T,t)}:function(t){return t&&function(){return T.apply(t,arguments)}},M=O,x=M({}.toString),k=M("".slice),E=function(t){return k(x(t),8,-1)},A=O,C=c,P=E,_=a.Object,I=A("".split),F=C((function(){return!_("z").propertyIsEnumerable(0)}))?function(t){return"String"==P(t)?I(t,""):_(t)}:_,D=a.TypeError,L=function(t){if(null==t)throw D("Can't call method on "+t);return t},N=F,G=L,W=function(t){return N(G(t))},z=function(t){return"function"==typeof t},B=z,R=function(t){return"object"==typeof t?null!==t:B(t)},q=a,J=z,Y=function(t){return J(t)?t:void 0},K=function(t,e){return arguments.length<2?Y(q[t]):q[t]&&q[t][e]},U=O({}.isPrototypeOf),X=K("navigator","userAgent")||"",H=a,Q=X,V=H.process,$=H.Deno,Z=V&&V.versions||$&&$.version,tt=Z&&Z.v8;tt&&(b=(y=tt.split("."))[0]>0&&y[0]<4?1:+(y[0]+y[1])),!b&&Q&&(!(y=Q.match(/Edge\/(\d+)/))||y[1]>=74)&&(y=Q.match(/Chrome\/(\d+)/))&&(b=+y[1]);var et=b,nt=et,rt=c,it=!!Object.getOwnPropertySymbols&&!rt((function(){var t=Symbol();return!String(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&nt&&nt<41})),ot=it&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,st=K,at=z,ut=U,ct=ot,lt=a.Object,ft=ct?function(t){return"symbol"==typeof t}:function(t){var e=st("Symbol");return at(e)&&ut(e.prototype,lt(t))},ht=a.String,pt=z,dt=function(t){try{return ht(t)}catch(t){return"Object"}},vt=a.TypeError,gt=function(t){if(pt(t))return t;throw vt(dt(t)+" is not a function")},yt=gt,bt=h,mt=z,wt=R,St=a.TypeError,Tt={exports:{}},jt=a,Ot=Object.defineProperty,Mt=function(t,e){try{Ot(jt,t,{value:e,configurable:!0,writable:!0})}catch(n){jt[t]=e}return e},xt=Mt,kt="__core-js_shared__",Et=a[kt]||xt(kt,{}),At=Et;(Tt.exports=function(t,e){return At[t]||(At[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.20.0",mode:"global",copyright:"Â© 2021 Denis Pushkarev (zloirock.ru)"});var Ct=L,Pt=a.Object,_t=function(t){return Pt(Ct(t))},It=_t,Ft=O({}.hasOwnProperty),Dt=Object.hasOwn||function(t,e){return Ft(It(t),e)},Lt=O,Nt=0,Gt=Math.random(),Wt=Lt(1..toString),zt=function(t){return"Symbol("+(void 0===t?"":t)+")_"+Wt(++Nt+Gt,36)},Bt=a,Rt=Tt.exports,qt=Dt,Jt=zt,Yt=it,Kt=ot,Ut=Rt("wks"),Xt=Bt.Symbol,Ht=Xt&&Xt.for,Qt=Kt?Xt:Xt&&Xt.withoutSetter||Jt,Vt=function(t){if(!qt(Ut,t)||!Yt&&"string"!=typeof Ut[t]){var e="Symbol."+t;Yt&&qt(Xt,t)?Ut[t]=Xt[t]:Ut[t]=Kt&&Ht?Ht(e):Qt(e)}return Ut[t]},$t=h,Zt=R,te=ft,ee=function(t,e){var n=t[e];return null==n?void 0:yt(n)},ne=function(t,e){var n,r;if("string"===e&&mt(n=t.toString)&&!wt(r=bt(n,t)))return r;if(mt(n=t.valueOf)&&!wt(r=bt(n,t)))return r;if("string"!==e&&mt(n=t.toString)&&!wt(r=bt(n,t)))return r;throw St("Can't convert object to primitive value")},re=Vt,ie=a.TypeError,oe=re("toPrimitive"),se=function(t,e){if(!Zt(t)||te(t))return t;var n,r=ee(t,oe);if(r){if(void 0===e&&(e="default"),n=$t(r,t,e),!Zt(n)||te(n))return n;throw ie("Can't convert object to primitive value")}return void 0===e&&(e="number"),ne(t,e)},ae=ft,ue=function(t){var e=se(t,"string");return ae(e)?e:e+""},ce=R,le=a.document,fe=ce(le)&&ce(le.createElement),he=function(t){return fe?le.createElement(t):{}},pe=!l&&!c((function(){return 7!=Object.defineProperty(he("div"),"a",{get:function(){return 7}}).a})),de=l,ve=h,ge=p,ye=m,be=W,me=ue,we=Dt,Se=pe,Te=Object.getOwnPropertyDescriptor;u.f=de?Te:function(t,e){if(t=be(t),e=me(e),Se)try{return Te(t,e)}catch(t){}if(we(t,e))return ye(!ve(ge.f,t,e),t[e])};var je={},Oe=a,Me=R,xe=Oe.String,ke=Oe.TypeError,Ee=function(t){if(Me(t))return t;throw ke(xe(t)+" is not an object")},Ae=l,Ce=pe,Pe=Ee,_e=ue,Ie=a.TypeError,Fe=Object.defineProperty;je.f=Ae?Fe:function(t,e,n){if(Pe(t),e=_e(e),Pe(n),Ce)try{return Fe(t,e,n)}catch(t){}if("get"in n||"set"in n)throw Ie("Accessors not supported");return"value"in n&&(t[e]=n.value),t};var De=je,Le=m,Ne=l?function(t,e,n){return De.f(t,e,Le(1,n))}:function(t,e,n){return t[e]=n,t},Ge={exports:{}},We=z,ze=Et,Be=O(Function.toString);We(ze.inspectSource)||(ze.inspectSource=function(t){return Be(t)});var Re,qe,Je,Ye=ze.inspectSource,Ke=z,Ue=Ye,Xe=a.WeakMap,He=Ke(Xe)&&/native code/.test(Ue(Xe)),Qe=Tt.exports,Ve=zt,$e=Qe("keys"),Ze={},tn=He,en=a,nn=O,rn=R,on=Ne,sn=Dt,an=Et,un=function(t){return $e[t]||($e[t]=Ve(t))},cn=Ze,ln="Object already initialized",fn=en.TypeError,hn=en.WeakMap;if(tn||an.state){var pn=an.state||(an.state=new hn),dn=nn(pn.get),vn=nn(pn.has),gn=nn(pn.set);Re=function(t,e){if(vn(pn,t))throw new fn(ln);return e.facade=t,gn(pn,t,e),e},qe=function(t){return dn(pn,t)||{}},Je=function(t){return vn(pn,t)}}else{var yn=un("state");cn[yn]=!0,Re=function(t,e){if(sn(t,yn))throw new fn(ln);return e.facade=t,on(t,yn,e),e},qe=function(t){return sn(t,yn)?t[yn]:{}},Je=function(t){return sn(t,yn)}}var bn={set:Re,get:qe,has:Je,enforce:function(t){return Je(t)?qe(t):Re(t,{})},getterFor:function(t){return function(e){var n;if(!rn(e)||(n=qe(e)).type!==t)throw fn("Incompatible receiver, "+t+" required");return n}}},mn=l,wn=Dt,Sn=Function.prototype,Tn=mn&&Object.getOwnPropertyDescriptor,jn=wn(Sn,"name"),On=jn&&"something"===function(){}.name,Mn=jn&&(!mn||mn&&Tn(Sn,"name").configurable),xn=a,kn=z,En=Dt,An=Ne,Cn=Mt,Pn=Ye,_n={EXISTS:jn,PROPER:On,CONFIGURABLE:Mn}.CONFIGURABLE,In=bn.get,Fn=bn.enforce,Dn=String(String).split("String");(Ge.exports=function(t,e,n,r){var i,o=!!r&&!!r.unsafe,s=!!r&&!!r.enumerable,a=!!r&&!!r.noTargetGet,u=r&&void 0!==r.name?r.name:e;kn(n)&&("Symbol("===String(u).slice(0,7)&&(u="["+String(u).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),(!En(n,"name")||_n&&n.name!==u)&&An(n,"name",u),(i=Fn(n)).source||(i.source=Dn.join("string"==typeof u?u:""))),t!==xn?(o?!a&&t[e]&&(s=!0):delete t[e],s?t[e]=n:An(t,e,n)):s?t[e]=n:Cn(e,n)})(Function.prototype,"toString",(function(){return kn(this)&&In(this).source||Pn(this)}));var Ln={},Nn=Math.ceil,Gn=Math.floor,Wn=function(t){var e=+t;return e!=e||0===e?0:(e>0?Gn:Nn)(e)},zn=Wn,Bn=Math.max,Rn=Math.min,qn=function(t,e){var n=zn(t);return n<0?Bn(n+e,0):Rn(n,e)},Jn=Wn,Yn=Math.min,Kn=function(t){return t>0?Yn(Jn(t),9007199254740991):0},Un=function(t){return Kn(t.length)},Xn=W,Hn=qn,Qn=Un,Vn=function(t){return function(e,n,r){var i,o=Xn(e),s=Qn(o),a=Hn(r,s);if(t&&n!=n){for(;s>a;)if((i=o[a++])!=i)return!0}else for(;s>a;a++)if((t||a in o)&&o[a]===n)return t||a||0;return!t&&-1}},$n={includes:Vn(!0),indexOf:Vn(!1)},Zn=Dt,tr=W,er=$n.indexOf,nr=Ze,rr=O([].push),ir=function(t,e){var n,r=tr(t),i=0,o=[];for(n in r)!Zn(nr,n)&&Zn(r,n)&&rr(o,n);for(;e.length>i;)Zn(r,n=e[i++])&&(~er(o,n)||rr(o,n));return o},or=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],sr=ir,ar=or.concat("length","prototype");Ln.f=Object.getOwnPropertyNames||function(t){return sr(t,ar)};var ur={};ur.f=Object.getOwnPropertySymbols;var cr=K,lr=Ln,fr=ur,hr=Ee,pr=O([].concat),dr=cr("Reflect","ownKeys")||function(t){var e=lr.f(hr(t)),n=fr.f;return n?pr(e,n(t)):e},vr=Dt,gr=dr,yr=u,br=je,mr=c,wr=z,Sr=/#|\.prototype\./,Tr=function(t,e){var n=Or[jr(t)];return n==xr||n!=Mr&&(wr(e)?mr(e):!!e)},jr=Tr.normalize=function(t){return String(t).replace(Sr,".").toLowerCase()},Or=Tr.data={},Mr=Tr.NATIVE="N",xr=Tr.POLYFILL="P",kr=Tr,Er=a,Ar=u.f,Cr=Ne,Pr=Ge.exports,_r=Mt,Ir=function(t,e,n){for(var r=gr(e),i=br.f,o=yr.f,s=0;s<r.length;s++){var a=r[s];vr(t,a)||n&&vr(n,a)||i(t,a,o(e,a))}},Fr=kr,Dr=function(t,e){var n,r,i,o,s,a=t.target,u=t.global,c=t.stat;if(n=u?Er:c?Er[a]||_r(a,{}):(Er[a]||{}).prototype)for(r in e){if(o=e[r],i=t.noTargetGet?(s=Ar(n,r))&&s.value:n[r],!Fr(u?r:a+(c?".":"#")+r,t.forced)&&void 0!==i){if(typeof o==typeof i)continue;Ir(o,i)}(t.sham||i&&i.sham)&&Cr(o,"sham",!0),Pr(n,r,o,t)}},Lr={};Lr[Vt("toStringTag")]="z";var Nr=a,Gr="[object z]"===String(Lr),Wr=z,zr=E,Br=Vt("toStringTag"),Rr=Nr.Object,qr="Arguments"==zr(function(){return arguments}()),Jr=Gr?zr:function(t){var e,n,r;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=function(t,e){try{return t[e]}catch(t){}}(e=Rr(t),Br))?n:qr?zr(e):"Object"==(r=zr(e))&&Wr(e.callee)?"Arguments":r},Yr=Jr,Kr=a.String,Ur=ue,Xr=je,Hr=m,Qr=function(t,e,n){var r=Ur(e);r in t?Xr.f(t,r,Hr(0,n)):t[r]=n},Vr=qn,$r=Un,Zr=Qr,ti=a.Array,ei=Math.max,ni=function(t,e,n){for(var r=$r(t),i=Vr(e,r),o=Vr(void 0===n?r:n,r),s=ti(ei(o-i,0)),a=0;i<o;i++,a++)Zr(s,a,t[i]);return s.length=a,s},ri=Math.floor,ii=function(t,e){var n=t.length,r=ri(n/2);return n<8?oi(t,e):si(t,ii(ni(t,0,r),e),ii(ni(t,r),e),e)},oi=function(t,e){for(var n,r,i=t.length,o=1;o<i;){for(r=o,n=t[o];r&&e(t[r-1],n)>0;)t[r]=t[--r];r!==o++&&(t[r]=n)}return t},si=function(t,e,n,r){for(var i=e.length,o=n.length,s=0,a=0;s<i||a<o;)t[s+a]=s<i&&a<o?r(e[s],n[a])<=0?e[s++]:n[a++]:s<i?e[s++]:n[a++];return t},ai=ii,ui=c,ci=X.match(/firefox\/(\d+)/i),li=!!ci&&+ci[1],fi=/MSIE|Trident/.test(X),hi=X.match(/AppleWebKit\/(\d+)\./),pi=!!hi&&+hi[1],di=Dr,vi=O,gi=gt,yi=_t,bi=Un,mi=function(t){if("Symbol"===Yr(t))throw TypeError("Cannot convert a Symbol value to a string");return Kr(t)},wi=c,Si=ai,Ti=function(t,e){var n=[][t];return!!n&&ui((function(){n.call(null,e||function(){throw 1},1)}))},ji=li,Oi=fi,Mi=et,xi=pi,ki=[],Ei=vi(ki.sort),Ai=vi(ki.push),Ci=wi((function(){ki.sort(void 0)})),Pi=wi((function(){ki.sort(null)})),_i=Ti("sort"),Ii=!wi((function(){if(Mi)return Mi<70;if(!(ji&&ji>3)){if(Oi)return!0;if(xi)return xi<603;var t,e,n,r,i="";for(t=65;t<76;t++){switch(e=String.fromCharCode(t),t){case 66:case 69:case 70:case 72:n=3;break;case 68:case 71:n=4;break;default:n=2}for(r=0;r<47;r++)ki.push({k:e+r,v:n})}for(ki.sort((function(t,e){return e.v-t.v})),r=0;r<ki.length;r++)e=ki[r].k.charAt(0),i.charAt(i.length-1)!==e&&(i+=e);return"DGBEFHACIJK"!==i}}));di({target:"Array",proto:!0,forced:Ci||!Pi||!_i||!Ii},{sort:function(t){void 0!==t&&gi(t);var e=yi(this);if(Ii)return void 0===t?Ei(e):Ei(e,t);var n,r,i=[],o=bi(e);for(r=0;r<o;r++)r in e&&Ai(i,e[r]);for(Si(i,function(t){return function(e,n){return void 0===n?-1:void 0===e?1:void 0!==t?+t(e,n)||0:mi(e)>mi(n)?1:-1}}(t)),n=i.length,r=0;r<n;)e[r]=i[r++];for(;r<o;)delete e[r++];return e}});var Fi=ir,Di=or,Li=Object.keys||function(t){return Fi(t,Di)},Ni=l,Gi=O,Wi=h,zi=c,Bi=Li,Ri=ur,qi=p,Ji=_t,Yi=F,Ki=Object.assign,Ui=Object.defineProperty,Xi=Gi([].concat),Hi=!Ki||zi((function(){if(Ni&&1!==Ki({b:1},Ki(Ui({},"a",{enumerable:!0,get:function(){Ui(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var t={},e={},n=Symbol(),r="abcdefghijklmnopqrst";return t[n]=7,r.split("").forEach((function(t){e[t]=t})),7!=Ki({},t)[n]||Bi(Ki({},e)).join("")!=r}))?function(t,e){for(var n=Ji(t),r=arguments.length,i=1,o=Ri.f,s=qi.f;r>i;)for(var a,u=Yi(arguments[i++]),c=o?Xi(Bi(u),o(u)):Bi(u),l=c.length,f=0;l>f;)a=c[f++],Ni&&!Wi(s,u,a)||(n[a]=u[a]);return n}:Ki,Qi=Hi;Dr({target:"Object",stat:!0,forced:Object.assign!==Qi},{assign:Qi});var Vi=E,$i=Array.isArray||function(t){return"Array"==Vi(t)},Zi=O,to=c,eo=z,no=Jr,ro=Ye,io=function(){},oo=[],so=K("Reflect","construct"),ao=/^\s*(?:class|function)\b/,uo=Zi(ao.exec),co=!ao.exec(io),lo=function(t){if(!eo(t))return!1;try{return so(io,oo,t),!0}catch(t){return!1}},fo=function(t){if(!eo(t))return!1;switch(no(t)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return co||!!uo(ao,ro(t))}catch(t){return!0}};fo.sham=!0;var ho=!so||to((function(){var t;return lo(lo.call)||!lo(Object)||!lo((function(){t=!0}))||t}))?fo:lo,po=a,vo=$i,go=ho,yo=R,bo=Vt("species"),mo=po.Array,wo=function(t){var e;return vo(t)&&(e=t.constructor,(go(e)&&(e===mo||vo(e.prototype))||yo(e)&&null===(e=e[bo]))&&(e=void 0)),void 0===e?mo:e},So=c,To=et,jo=Vt("species"),Oo=Dr,Mo=a,xo=c,ko=$i,Eo=R,Ao=_t,Co=Un,Po=Qr,_o=function(t,e){return new(wo(t))(0===e?0:e)},Io=function(t){return To>=51||!So((function(){var e=[];return(e.constructor={})[jo]=function(){return{foo:1}},1!==e[t](Boolean).foo}))},Fo=et,Do=Vt("isConcatSpreadable"),Lo=9007199254740991,No="Maximum allowed index exceeded",Go=Mo.TypeError,Wo=Fo>=51||!xo((function(){var t=[];return t[Do]=!1,t.concat()[0]!==t})),zo=Io("concat"),Bo=function(t){if(!Eo(t))return!1;var e=t[Do];return void 0!==e?!!e:ko(t)};Oo({target:"Array",proto:!0,forced:!Wo||!zo},{concat:function(t){var e,n,r,i,o,s=Ao(this),a=_o(s,0),u=0;for(e=-1,r=arguments.length;e<r;e++)if(Bo(o=-1===e?s:arguments[e])){if(u+(i=Co(o))>Lo)throw Go(No);for(n=0;n<i;n++,u++)n in o&&Po(a,u,o[n])}else{if(u>=Lo)throw Go(No);Po(a,u++,o)}return a.length=u,a}});var Ro=new n.default.TimeCapsule,qo="@donkeyclip/scrollbar_player",Jo=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r(this,t),this.clip=e.clip,this.host=this.clip.props.host,this.swipeAxis="vertical"===(e.swipeAxis||"vertical")?"clientY":"clientX";var i=e.mode||"free";"free"===i?(this.host.onwheel=this.handlePlainWheel.bind(this),this.journey=Ro.startJourney(this.clip),this.host.addEventListener("touchstart",this._touchstart.bind(this)),this.host.addEventListener("touchmove",this._touchmove.bind(this))):"chapters"===i&&(this.transitionTimeout=null,this.transitionSpeed=e.transitionSpeed||1,this.easing=n.default.utils.easings[e.easing||"easeOutQuart"],this.transitionStart=null,e.chapters.sort((function(t,e){return t.millisecond-e.millisecond})),this.chapters=e.chapters,this.transitioning=!1,this.host.onwheel=this.handleChapterWheel.bind(this),this.host.addEventListener("touchstart",this._touchstart.bind(this)),this.host.addEventListener("touchmove",this._touchmove.bind(this)),this.host.addEventListener("touchend",this._chapterTouchend.bind(this)));var o=5/(e.wheelSpeed||5);this.speed=1/o;var s={display:!0,position:"right",color:"purple"};void 0!==e.progressBar&&Object.assign(s,e.progressBar),this._setupScrollbar(s)}var e,o,s;return e=t,(o=[{key:"_setupScrollbar",value:function(t){var e=this;if(!1!==t.display){var n,r,i=document.createElement("div");switch(i.setAttribute("id","".concat(qo,"-scrollbarId")),t.position){case"left":n="left:0px; top: 0px; width: 2px; height: 0%;",r="height";break;case"right":n="right:0px; top: 0px; width: 2px; height: 0%;",r="height";break;case"top":n="top:0px; left: 0px; height: 2px; width: 0%;",r="width";break;case"bottom":n="bottom:0px; left: 0px; height: 2px; width: 0%;",r="width"}i.setAttribute("style","".concat(n," position:absolute; background: ").concat(t.color,";")),this.host.appendChild(i),this.clip.subscribe("".concat(qo,"_").concat((new Date).getTime()),(function(t){i.style[r]="".concat(100*t/e.clip.duration,"%")}))}}},{key:"_touchstart",value:function(t){t.preventDefault(),1===t.touches.length&&(this.previousTouch=t.touches[0][this.swipeAxis],this.transitioning=!1)}},{key:"_touchmove",value:function(t){t.preventDefault(),this.transitioning=!1,null!==this.transitionTimeout&&clearTimeout(this.transitionTimeout);var e=this.previousTouch-event.touches[0][this.swipeAxis];this.direction=e>0?"fw":"bw",this.previousTouch=event.touches[0][this.swipeAxis];var n=10*e*this.speed,r=Ro.startJourney(this.clip),i=this.clip.runTimeInfo.currentMillisecond+n;i<0?(i=0,n=0):i>this.clip.duration&&(i=this.clip.duration,n=0),r.destination(i)}},{key:"_chapterTouchend",value:function(t){var e=this;if(t.preventDefault(),"fw"===this.direction&&this.clip.runTimeInfo.currentMillisecond!==this.clip.duration){var n=this._getNextChapter(this.clip.runTimeInfo.currentMillisecond);this.transitionTimeout=setTimeout((function(){e.transitionToChapter(n,"fw")}),this.latency)}else if("bw"===this.direction&&0!==this.clip.runTimeInfo.currentMillisecond){var r=this._getPreviousChapter(this.clip.runTimeInfo.currentMillisecond);this.transitionTimeout=setTimeout((function(){e.transitionToChapter(r,"bw")}),this.latency)}}},{key:"_getNextChapter",value:function(t){for(var e=0;e<this.chapters.length;e++){var n=this.chapters[e];if(n.millisecond>t)return n.millisecond}return this.clip.duration}},{key:"_getPreviousChapter",value:function(t){for(var e=this.chapters.length-1;e>=0;e--){var n=this.chapters[e];if(n.millisecond<t)return n.millisecond}return 0}},{key:"handleChapterWheel",value:function(t){var e=this;t.preventDefault(),this.transitioning=!1,null!==this.transitionTimeout&&clearTimeout(this.transitionTimeout);var n=t.deltaY*this.speed,r=Ro.startJourney(this.clip),i=this.clip.runTimeInfo.currentMillisecond+n;if(i<0?(i=0,n=0):i>this.clip.duration&&(i=this.clip.duration,n=0),n>0){var o=this._getNextChapter(i);this.transitionTimeout=setTimeout((function(){e.transitionToChapter(o,"fw")}),this.latency)}else if(n<0){var s=this._getPreviousChapter(i);this.transitionTimeout=setTimeout((function(){e.transitionToChapter(s,"bw")}),this.latency)}r.destination(i)}},{key:"transitionToChapter",value:function(t){this.transitioning=!0,this.transitionStart=null,this.targetMillisecond=t,this.startMillisecond=this.clip.runTimeInfo.currentMillisecond,this.journey=Ro.startJourney(this.clip),this.direction=this.targetMillisecond>=this.startMillisecond?"fw":"bw",window.requestAnimationFrame(this._step.bind(this))}},{key:"_step",value:function(t){null===this.transitionStart&&(this.transitionStart=t);var e,n=t-this.transitionStart,r=!1;if("fw"===this.direction?(e=this.startMillisecond+n*this.transitionSpeed)>this.targetMillisecond&&(e=this.targetMillisecond,r=!0):(e=this.startMillisecond-n*this.transitionSpeed)<this.targetMillisecond&&(e=this.targetMillisecond,r=!0),!1!==this.transitioning){var i,o=Math.abs(e-this.startMillisecond)/Math.abs(this.targetMillisecond-this.startMillisecond);i="fw"===this.direction?this.startMillisecond+this.easing(o)*(this.targetMillisecond-this.startMillisecond):this.startMillisecond-this.easing(o)*(this.startMillisecond-this.targetMillisecond),this.journey.station(i),r?this.journey.destination():window.requestAnimationFrame(this._step.bind(this))}}},{key:"handlePlainWheel",value:function(t){t.preventDefault();var e=t.deltaY*this.speed,n=this.clip.runTimeInfo.currentMillisecond+e;n<0?n=0:n>this.clip.duration&&(n=this.clip.duration),this.journey.station(n)}}])&&i(e.prototype,o),s&&i(e,s),Object.defineProperty(e,"prototype",{writable:!1}),t}();return Jo}));
