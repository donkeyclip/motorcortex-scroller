!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("@donkeyclip/motorcortex")):"function"==typeof define&&define.amd?define(["@donkeyclip/motorcortex"],e):(t="undefined"!=typeof globalThis?globalThis:t||self)["@donkeyclip/motorcortex-scroller"]=e(t.MotorCortex)}(this,(function(t){"use strict";function e(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var n=e(t);function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},s=function(t){return t&&t.Math==Math&&t},a=s("object"==typeof globalThis&&globalThis)||s("object"==typeof window&&window)||s("object"==typeof self&&self)||s("object"==typeof o&&o)||function(){return this}()||Function("return this")(),u={},c=function(t){try{return!!t()}catch(t){return!0}},l=!c((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]})),f=Function.prototype.call,h=f.bind?f.bind(f):function(){return f.apply(f,arguments)},p={},d={}.propertyIsEnumerable,v=Object.getOwnPropertyDescriptor,g=v&&!d.call({1:2},1);p.f=g?function(t){var e=v(this,t);return!!e&&e.enumerable}:d;var y,b,m=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}},w=Function.prototype,S=w.bind,T=w.call,j=S&&S.bind(T),O=S?function(t){return t&&j(T,t)}:function(t){return t&&function(){return T.apply(t,arguments)}},M=O,x=M({}.toString),k=M("".slice),E=function(t){return k(x(t),8,-1)},C=O,A=c,P=E,_=a.Object,I=C("".split),F=A((function(){return!_("z").propertyIsEnumerable(0)}))?function(t){return"String"==P(t)?I(t,""):_(t)}:_,D=a.TypeError,L=function(t){if(null==t)throw D("Can't call method on "+t);return t},N=F,G=L,W=function(t){return N(G(t))},z=function(t){return"function"==typeof t},B=z,R=function(t){return"object"==typeof t?null!==t:B(t)},q=a,J=z,Y=function(t){return J(t)?t:void 0},K=function(t,e){return arguments.length<2?Y(q[t]):q[t]&&q[t][e]},U=O({}.isPrototypeOf),X=K("navigator","userAgent")||"",H=a,Q=X,V=H.process,$=H.Deno,Z=V&&V.versions||$&&$.version,tt=Z&&Z.v8;tt&&(b=(y=tt.split("."))[0]>0&&y[0]<4?1:+(y[0]+y[1])),!b&&Q&&(!(y=Q.match(/Edge\/(\d+)/))||y[1]>=74)&&(y=Q.match(/Chrome\/(\d+)/))&&(b=+y[1]);var et=b,nt=et,rt=c,it=!!Object.getOwnPropertySymbols&&!rt((function(){var t=Symbol();return!String(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&nt&&nt<41})),ot=it&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,st=K,at=z,ut=U,ct=ot,lt=a.Object,ft=ct?function(t){return"symbol"==typeof t}:function(t){var e=st("Symbol");return at(e)&&ut(e.prototype,lt(t))},ht=a.String,pt=z,dt=function(t){try{return ht(t)}catch(t){return"Object"}},vt=a.TypeError,gt=function(t){if(pt(t))return t;throw vt(dt(t)+" is not a function")},yt=gt,bt=h,mt=z,wt=R,St=a.TypeError,Tt={exports:{}},jt=a,Ot=Object.defineProperty,Mt=function(t,e){try{Ot(jt,t,{value:e,configurable:!0,writable:!0})}catch(n){jt[t]=e}return e},xt=Mt,kt="__core-js_shared__",Et=a[kt]||xt(kt,{}),Ct=Et;(Tt.exports=function(t,e){return Ct[t]||(Ct[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.19.0",mode:"global",copyright:"Â© 2021 Denis Pushkarev (zloirock.ru)"});var At=L,Pt=a.Object,_t=function(t){return Pt(At(t))},It=_t,Ft=O({}.hasOwnProperty),Dt=Object.hasOwn||function(t,e){return Ft(It(t),e)},Lt=O,Nt=0,Gt=Math.random(),Wt=Lt(1..toString),zt=function(t){return"Symbol("+(void 0===t?"":t)+")_"+Wt(++Nt+Gt,36)},Bt=a,Rt=Tt.exports,qt=Dt,Jt=zt,Yt=it,Kt=ot,Ut=Rt("wks"),Xt=Bt.Symbol,Ht=Xt&&Xt.for,Qt=Kt?Xt:Xt&&Xt.withoutSetter||Jt,Vt=function(t){if(!qt(Ut,t)||!Yt&&"string"!=typeof Ut[t]){var e="Symbol."+t;Yt&&qt(Xt,t)?Ut[t]=Xt[t]:Ut[t]=Kt&&Ht?Ht(e):Qt(e)}return Ut[t]},$t=h,Zt=R,te=ft,ee=function(t,e){var n=t[e];return null==n?void 0:yt(n)},ne=function(t,e){var n,r;if("string"===e&&mt(n=t.toString)&&!wt(r=bt(n,t)))return r;if(mt(n=t.valueOf)&&!wt(r=bt(n,t)))return r;if("string"!==e&&mt(n=t.toString)&&!wt(r=bt(n,t)))return r;throw St("Can't convert object to primitive value")},re=Vt,ie=a.TypeError,oe=re("toPrimitive"),se=function(t,e){if(!Zt(t)||te(t))return t;var n,r=ee(t,oe);if(r){if(void 0===e&&(e="default"),n=$t(r,t,e),!Zt(n)||te(n))return n;throw ie("Can't convert object to primitive value")}return void 0===e&&(e="number"),ne(t,e)},ae=ft,ue=function(t){var e=se(t,"string");return ae(e)?e:e+""},ce=R,le=a.document,fe=ce(le)&&ce(le.createElement),he=function(t){return fe?le.createElement(t):{}},pe=!l&&!c((function(){return 7!=Object.defineProperty(he("div"),"a",{get:function(){return 7}}).a})),de=l,ve=h,ge=p,ye=m,be=W,me=ue,we=Dt,Se=pe,Te=Object.getOwnPropertyDescriptor;u.f=de?Te:function(t,e){if(t=be(t),e=me(e),Se)try{return Te(t,e)}catch(t){}if(we(t,e))return ye(!ve(ge.f,t,e),t[e])};var je={},Oe=a,Me=R,xe=Oe.String,ke=Oe.TypeError,Ee=function(t){if(Me(t))return t;throw ke(xe(t)+" is not an object")},Ce=l,Ae=pe,Pe=Ee,_e=ue,Ie=a.TypeError,Fe=Object.defineProperty;je.f=Ce?Fe:function(t,e,n){if(Pe(t),e=_e(e),Pe(n),Ae)try{return Fe(t,e,n)}catch(t){}if("get"in n||"set"in n)throw Ie("Accessors not supported");return"value"in n&&(t[e]=n.value),t};var De=je,Le=m,Ne=l?function(t,e,n){return De.f(t,e,Le(1,n))}:function(t,e,n){return t[e]=n,t},Ge={exports:{}},We=z,ze=Et,Be=O(Function.toString);We(ze.inspectSource)||(ze.inspectSource=function(t){return Be(t)});var Re,qe,Je,Ye=ze.inspectSource,Ke=z,Ue=Ye,Xe=a.WeakMap,He=Ke(Xe)&&/native code/.test(Ue(Xe)),Qe=Tt.exports,Ve=zt,$e=Qe("keys"),Ze={},tn=He,en=a,nn=O,rn=R,on=Ne,sn=Dt,an=Et,un=function(t){return $e[t]||($e[t]=Ve(t))},cn=Ze,ln="Object already initialized",fn=en.TypeError,hn=en.WeakMap;if(tn||an.state){var pn=an.state||(an.state=new hn),dn=nn(pn.get),vn=nn(pn.has),gn=nn(pn.set);Re=function(t,e){if(vn(pn,t))throw new fn(ln);return e.facade=t,gn(pn,t,e),e},qe=function(t){return dn(pn,t)||{}},Je=function(t){return vn(pn,t)}}else{var yn=un("state");cn[yn]=!0,Re=function(t,e){if(sn(t,yn))throw new fn(ln);return e.facade=t,on(t,yn,e),e},qe=function(t){return sn(t,yn)?t[yn]:{}},Je=function(t){return sn(t,yn)}}var bn={set:Re,get:qe,has:Je,enforce:function(t){return Je(t)?qe(t):Re(t,{})},getterFor:function(t){return function(e){var n;if(!rn(e)||(n=qe(e)).type!==t)throw fn("Incompatible receiver, "+t+" required");return n}}},mn=l,wn=Dt,Sn=Function.prototype,Tn=mn&&Object.getOwnPropertyDescriptor,jn=wn(Sn,"name"),On=jn&&"something"===function(){}.name,Mn=jn&&(!mn||mn&&Tn(Sn,"name").configurable),xn=a,kn=z,En=Dt,Cn=Ne,An=Mt,Pn=Ye,_n={EXISTS:jn,PROPER:On,CONFIGURABLE:Mn}.CONFIGURABLE,In=bn.get,Fn=bn.enforce,Dn=String(String).split("String");(Ge.exports=function(t,e,n,r){var i,o=!!r&&!!r.unsafe,s=!!r&&!!r.enumerable,a=!!r&&!!r.noTargetGet,u=r&&void 0!==r.name?r.name:e;kn(n)&&("Symbol("===String(u).slice(0,7)&&(u="["+String(u).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),(!En(n,"name")||_n&&n.name!==u)&&Cn(n,"name",u),(i=Fn(n)).source||(i.source=Dn.join("string"==typeof u?u:""))),t!==xn?(o?!a&&t[e]&&(s=!0):delete t[e],s?t[e]=n:Cn(t,e,n)):s?t[e]=n:An(e,n)})(Function.prototype,"toString",(function(){return kn(this)&&In(this).source||Pn(this)}));var Ln={},Nn=Math.ceil,Gn=Math.floor,Wn=function(t){var e=+t;return e!=e||0===e?0:(e>0?Gn:Nn)(e)},zn=Wn,Bn=Math.max,Rn=Math.min,qn=Wn,Jn=Math.min,Yn=function(t){return t>0?Jn(qn(t),9007199254740991):0},Kn=function(t){return Yn(t.length)},Un=W,Xn=function(t,e){var n=zn(t);return n<0?Bn(n+e,0):Rn(n,e)},Hn=Kn,Qn=function(t){return function(e,n,r){var i,o=Un(e),s=Hn(o),a=Xn(r,s);if(t&&n!=n){for(;s>a;)if((i=o[a++])!=i)return!0}else for(;s>a;a++)if((t||a in o)&&o[a]===n)return t||a||0;return!t&&-1}},Vn={includes:Qn(!0),indexOf:Qn(!1)},$n=Dt,Zn=W,tr=Vn.indexOf,er=Ze,nr=O([].push),rr=function(t,e){var n,r=Zn(t),i=0,o=[];for(n in r)!$n(er,n)&&$n(r,n)&&nr(o,n);for(;e.length>i;)$n(r,n=e[i++])&&(~tr(o,n)||nr(o,n));return o},ir=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],or=rr,sr=ir.concat("length","prototype");Ln.f=Object.getOwnPropertyNames||function(t){return or(t,sr)};var ar={};ar.f=Object.getOwnPropertySymbols;var ur=K,cr=Ln,lr=ar,fr=Ee,hr=O([].concat),pr=ur("Reflect","ownKeys")||function(t){var e=cr.f(fr(t)),n=lr.f;return n?hr(e,n(t)):e},dr=Dt,vr=pr,gr=u,yr=je,br=c,mr=z,wr=/#|\.prototype\./,Sr=function(t,e){var n=jr[Tr(t)];return n==Mr||n!=Or&&(mr(e)?br(e):!!e)},Tr=Sr.normalize=function(t){return String(t).replace(wr,".").toLowerCase()},jr=Sr.data={},Or=Sr.NATIVE="N",Mr=Sr.POLYFILL="P",xr=Sr,kr=a,Er=u.f,Cr=Ne,Ar=Ge.exports,Pr=Mt,_r=function(t,e){for(var n=vr(e),r=yr.f,i=gr.f,o=0;o<n.length;o++){var s=n[o];dr(t,s)||r(t,s,i(e,s))}},Ir=xr,Fr=function(t,e){var n,r,i,o,s,a=t.target,u=t.global,c=t.stat;if(n=u?kr:c?kr[a]||Pr(a,{}):(kr[a]||{}).prototype)for(r in e){if(o=e[r],i=t.noTargetGet?(s=Er(n,r))&&s.value:n[r],!Ir(u?r:a+(c?".":"#")+r,t.forced)&&void 0!==i){if(typeof o==typeof i)continue;_r(o,i)}(t.sham||i&&i.sham)&&Cr(o,"sham",!0),Ar(n,r,o,t)}},Dr={};Dr[Vt("toStringTag")]="z";var Lr=a,Nr="[object z]"===String(Dr),Gr=z,Wr=E,zr=Vt("toStringTag"),Br=Lr.Object,Rr="Arguments"==Wr(function(){return arguments}()),qr=Nr?Wr:function(t){var e,n,r;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=function(t,e){try{return t[e]}catch(t){}}(e=Br(t),zr))?n:Rr?Wr(e):"Object"==(r=Wr(e))&&Gr(e.callee)?"Arguments":r},Jr=qr,Yr=a.String,Kr=O([].slice),Ur=Math.floor,Xr=function(t,e){var n=t.length,r=Ur(n/2);return n<8?Hr(t,e):Qr(t,Xr(Kr(t,0,r),e),Xr(Kr(t,r),e),e)},Hr=function(t,e){for(var n,r,i=t.length,o=1;o<i;){for(r=o,n=t[o];r&&e(t[r-1],n)>0;)t[r]=t[--r];r!==o++&&(t[r]=n)}return t},Qr=function(t,e,n,r){for(var i=e.length,o=n.length,s=0,a=0;s<i||a<o;)t[s+a]=s<i&&a<o?r(e[s],n[a])<=0?e[s++]:n[a++]:s<i?e[s++]:n[a++];return t},Vr=Xr,$r=c,Zr=X.match(/firefox\/(\d+)/i),ti=!!Zr&&+Zr[1],ei=/MSIE|Trident/.test(X),ni=X.match(/AppleWebKit\/(\d+)\./),ri=!!ni&&+ni[1],ii=Fr,oi=O,si=gt,ai=_t,ui=Kn,ci=function(t){if("Symbol"===Jr(t))throw TypeError("Cannot convert a Symbol value to a string");return Yr(t)},li=c,fi=Vr,hi=function(t,e){var n=[][t];return!!n&&$r((function(){n.call(null,e||function(){throw 1},1)}))},pi=ti,di=ei,vi=et,gi=ri,yi=[],bi=oi(yi.sort),mi=oi(yi.push),wi=li((function(){yi.sort(void 0)})),Si=li((function(){yi.sort(null)})),Ti=hi("sort"),ji=!li((function(){if(vi)return vi<70;if(!(pi&&pi>3)){if(di)return!0;if(gi)return gi<603;var t,e,n,r,i="";for(t=65;t<76;t++){switch(e=String.fromCharCode(t),t){case 66:case 69:case 70:case 72:n=3;break;case 68:case 71:n=4;break;default:n=2}for(r=0;r<47;r++)yi.push({k:e+r,v:n})}for(yi.sort((function(t,e){return e.v-t.v})),r=0;r<yi.length;r++)e=yi[r].k.charAt(0),i.charAt(i.length-1)!==e&&(i+=e);return"DGBEFHACIJK"!==i}}));ii({target:"Array",proto:!0,forced:wi||!Si||!Ti||!ji},{sort:function(t){void 0!==t&&si(t);var e=ai(this);if(ji)return void 0===t?bi(e):bi(e,t);var n,r,i=[],o=ui(e);for(r=0;r<o;r++)r in e&&mi(i,e[r]);for(fi(i,function(t){return function(e,n){return void 0===n?-1:void 0===e?1:void 0!==t?+t(e,n)||0:ci(e)>ci(n)?1:-1}}(t)),n=i.length,r=0;r<n;)e[r]=i[r++];for(;r<o;)delete e[r++];return e}});var Oi=rr,Mi=ir,xi=Object.keys||function(t){return Oi(t,Mi)},ki=l,Ei=O,Ci=h,Ai=c,Pi=xi,_i=ar,Ii=p,Fi=_t,Di=F,Li=Object.assign,Ni=Object.defineProperty,Gi=Ei([].concat),Wi=!Li||Ai((function(){if(ki&&1!==Li({b:1},Li(Ni({},"a",{enumerable:!0,get:function(){Ni(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var t={},e={},n=Symbol(),r="abcdefghijklmnopqrst";return t[n]=7,r.split("").forEach((function(t){e[t]=t})),7!=Li({},t)[n]||Pi(Li({},e)).join("")!=r}))?function(t,e){for(var n=Fi(t),r=arguments.length,i=1,o=_i.f,s=Ii.f;r>i;)for(var a,u=Di(arguments[i++]),c=o?Gi(Pi(u),o(u)):Pi(u),l=c.length,f=0;l>f;)a=c[f++],ki&&!Ci(s,u,a)||(n[a]=u[a]);return n}:Li,zi=Wi;Fr({target:"Object",stat:!0,forced:Object.assign!==zi},{assign:zi});var Bi=E,Ri=Array.isArray||function(t){return"Array"==Bi(t)},qi=ue,Ji=je,Yi=m,Ki=O,Ui=c,Xi=z,Hi=qr,Qi=Ye,Vi=function(){},$i=[],Zi=K("Reflect","construct"),to=/^\s*(?:class|function)\b/,eo=Ki(to.exec),no=!to.exec(Vi),ro=function(t){if(!Xi(t))return!1;try{return Zi(Vi,$i,t),!0}catch(t){return!1}},io=!Zi||Ui((function(){var t;return ro(ro.call)||!ro(Object)||!ro((function(){t=!0}))||t}))?function(t){if(!Xi(t))return!1;switch(Hi(t)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}return no||!!eo(to,Qi(t))}:ro,oo=a,so=Ri,ao=io,uo=R,co=Vt("species"),lo=oo.Array,fo=function(t){var e;return so(t)&&(e=t.constructor,(ao(e)&&(e===lo||so(e.prototype))||uo(e)&&null===(e=e[co]))&&(e=void 0)),void 0===e?lo:e},ho=c,po=et,vo=Vt("species"),go=Fr,yo=a,bo=c,mo=Ri,wo=R,So=_t,To=Kn,jo=function(t,e,n){var r=qi(e);r in t?Ji.f(t,r,Yi(0,n)):t[r]=n},Oo=function(t,e){return new(fo(t))(0===e?0:e)},Mo=function(t){return po>=51||!ho((function(){var e=[];return(e.constructor={})[vo]=function(){return{foo:1}},1!==e[t](Boolean).foo}))},xo=et,ko=Vt("isConcatSpreadable"),Eo=9007199254740991,Co="Maximum allowed index exceeded",Ao=yo.TypeError,Po=xo>=51||!bo((function(){var t=[];return t[ko]=!1,t.concat()[0]!==t})),_o=Mo("concat"),Io=function(t){if(!wo(t))return!1;var e=t[ko];return void 0!==e?!!e:mo(t)};go({target:"Array",proto:!0,forced:!Po||!_o},{concat:function(t){var e,n,r,i,o,s=So(this),a=Oo(s,0),u=0;for(e=-1,r=arguments.length;e<r;e++)if(Io(o=-1===e?s:arguments[e])){if(u+(i=To(o))>Eo)throw Ao(Co);for(n=0;n<i;n++,u++)n in o&&jo(a,u,o[n])}else{if(u>=Eo)throw Ao(Co);jo(a,u++,o)}return a.length=u,a}});var Fo=new n.default.TimeCapsule,Do="@donkeyclip/scrollbar_player",Lo=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r(this,t),this.clip=e.clip,this.host=this.clip.props.host,this.swipeAxis="vertical"===(e.swipeAxis||"vertical")?"clientY":"clientX";var i=e.mode||"free";"free"===i?(this.host.onwheel=this.handlePlainWheel.bind(this),this.journey=Fo.startJourney(this.clip),this.host.addEventListener("touchstart",this._touchstart.bind(this)),this.host.addEventListener("touchmove",this._touchmove.bind(this))):"chapters"===i&&(this.transitionTimeout=null,this.transitionSpeed=e.transitionSpeed||1,this.easing=n.default.utils.easings[e.easing||"easeOutQuart"],this.transitionStart=null,e.chapters.sort((function(t,e){return t.millisecond-e.millisecond})),this.chapters=e.chapters,this.transitioning=!1,this.host.onwheel=this.handleChapterWheel.bind(this),this.host.addEventListener("touchstart",this._touchstart.bind(this)),this.host.addEventListener("touchmove",this._touchmove.bind(this)),this.host.addEventListener("touchend",this._chapterTouchend.bind(this)));var o=5/(e.wheelSpeed||5);this.speed=1/o;var s={display:!0,position:"right",color:"purple"};void 0!==e.progressBar&&Object.assign(s,e.progressBar),this._setupScrollbar(s)}var e,o,s;return e=t,(o=[{key:"_setupScrollbar",value:function(t){var e=this;if(!1!==t.display){var n,r,i=document.createElement("div");switch(i.setAttribute("id","".concat(Do,"-scrollbarId")),t.position){case"left":n="left:0px; top: 0px; width: 2px; height: 0%;",r="height";break;case"right":n="right:0px; top: 0px; width: 2px; height: 0%;",r="height";break;case"top":n="top:0px; left: 0px; height: 2px; width: 0%;",r="width";break;case"bottom":n="bottom:0px; left: 0px; height: 2px; width: 0%;",r="width"}i.setAttribute("style","".concat(n," position:absolute; background: ").concat(t.color,";")),this.host.appendChild(i),this.clip.subscribe("".concat(Do,"_").concat((new Date).getTime()),(function(t){i.style[r]="".concat(100*t/e.clip.duration,"%")}))}}},{key:"_touchstart",value:function(t){t.preventDefault(),1===t.touches.length&&(this.previousTouch=t.touches[0][this.swipeAxis],this.transitioning=!1)}},{key:"_touchmove",value:function(t){t.preventDefault(),this.transitioning=!1,null!==this.transitionTimeout&&clearTimeout(this.transitionTimeout);var e=this.previousTouch-event.touches[0][this.swipeAxis];this.direction=e>0?"fw":"bw",this.previousTouch=event.touches[0][this.swipeAxis];var n=10*e*this.speed,r=Fo.startJourney(this.clip),i=this.clip.runTimeInfo.currentMillisecond+n;i<0?(i=0,n=0):i>this.clip.duration&&(i=this.clip.duration,n=0),r.destination(i)}},{key:"_chapterTouchend",value:function(t){var e=this;if(t.preventDefault(),"fw"===this.direction&&this.clip.runTimeInfo.currentMillisecond!==this.clip.duration){var n=this._getNextChapter(this.clip.runTimeInfo.currentMillisecond);this.transitionTimeout=setTimeout((function(){e.transitionToChapter(n,"fw")}),this.latency)}else if("bw"===this.direction&&0!==this.clip.runTimeInfo.currentMillisecond){var r=this._getPreviousChapter(this.clip.runTimeInfo.currentMillisecond);this.transitionTimeout=setTimeout((function(){e.transitionToChapter(r,"bw")}),this.latency)}}},{key:"_getNextChapter",value:function(t){for(var e=0;e<this.chapters.length;e++){var n=this.chapters[e];if(n.millisecond>t)return n.millisecond}return this.clip.duration}},{key:"_getPreviousChapter",value:function(t){for(var e=this.chapters.length-1;e>=0;e--){var n=this.chapters[e];if(n.millisecond<t)return n.millisecond}return 0}},{key:"handleChapterWheel",value:function(t){var e=this;t.preventDefault(),this.transitioning=!1,null!==this.transitionTimeout&&clearTimeout(this.transitionTimeout);var n=t.deltaY*this.speed,r=Fo.startJourney(this.clip),i=this.clip.runTimeInfo.currentMillisecond+n;if(i<0?(i=0,n=0):i>this.clip.duration&&(i=this.clip.duration,n=0),n>0){var o=this._getNextChapter(i);this.transitionTimeout=setTimeout((function(){e.transitionToChapter(o,"fw")}),this.latency)}else if(n<0){var s=this._getPreviousChapter(i);this.transitionTimeout=setTimeout((function(){e.transitionToChapter(s,"bw")}),this.latency)}r.destination(i)}},{key:"transitionToChapter",value:function(t){this.transitioning=!0,this.transitionStart=null,this.targetMillisecond=t,this.startMillisecond=this.clip.runTimeInfo.currentMillisecond,this.journey=Fo.startJourney(this.clip),this.direction=this.targetMillisecond>=this.startMillisecond?"fw":"bw",window.requestAnimationFrame(this._step.bind(this))}},{key:"_step",value:function(t){null===this.transitionStart&&(this.transitionStart=t);var e,n=t-this.transitionStart,r=!1;if("fw"===this.direction?(e=this.startMillisecond+n*this.transitionSpeed)>this.targetMillisecond&&(e=this.targetMillisecond,r=!0):(e=this.startMillisecond-n*this.transitionSpeed)<this.targetMillisecond&&(e=this.targetMillisecond,r=!0),!1!==this.transitioning){var i,o=Math.abs(e-this.startMillisecond)/Math.abs(this.targetMillisecond-this.startMillisecond);i="fw"===this.direction?this.startMillisecond+this.easing(o)*(this.targetMillisecond-this.startMillisecond):this.startMillisecond-this.easing(o)*(this.startMillisecond-this.targetMillisecond),this.journey.station(i),r?this.journey.destination():window.requestAnimationFrame(this._step.bind(this))}}},{key:"handlePlainWheel",value:function(t){t.preventDefault();var e=t.deltaY*this.speed,n=this.clip.runTimeInfo.currentMillisecond+e;n<0?n=0:n>this.clip.duration&&(n=this.clip.duration),this.journey.station(n)}}])&&i(e.prototype,o),s&&i(e,s),t}();return Lo}));
