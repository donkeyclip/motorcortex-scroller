!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("@donkeyclip/motorcortex")):"function"==typeof define&&define.amd?define(["@donkeyclip/motorcortex"],e):(t="undefined"!=typeof globalThis?globalThis:t||self)["@donkeyclip/motorcortex-scroller"]=e(t.MotorCortex)}(this,(function(t){"use strict";function e(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var n=e(t);function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},s=function(t){return t&&t.Math==Math&&t},a=s("object"==typeof globalThis&&globalThis)||s("object"==typeof window&&window)||s("object"==typeof self&&self)||s("object"==typeof o&&o)||function(){return this}()||Function("return this")(),u={},c=function(t){try{return!!t()}catch(t){return!0}},l=!c((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]})),f=Function.prototype.call,h=f.bind?f.bind(f):function(){return f.apply(f,arguments)},p={},d={}.propertyIsEnumerable,v=Object.getOwnPropertyDescriptor,b=v&&!d.call({1:2},1);p.f=b?function(t){var e=v(this,t);return!!e&&e.enumerable}:d;var y,g,m=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}},w=Function.prototype,S=w.bind,T=w.call,O=S&&S.bind(T,T),j=S?function(t){return t&&O(t)}:function(t){return t&&function(){return T.apply(t,arguments)}},M=j,x=M({}.toString),k=M("".slice),E=function(t){return k(x(t),8,-1)},P=j,A=c,C=E,_=a.Object,I=P("".split),F=A((function(){return!_("z").propertyIsEnumerable(0)}))?function(t){return"String"==C(t)?I(t,""):_(t)}:_,D=a.TypeError,L=function(t){if(null==t)throw D("Can't call method on "+t);return t},N=F,G=L,W=function(t){return N(G(t))},z=function(t){return"function"==typeof t},B=z,R=function(t){return"object"==typeof t?null!==t:B(t)},q=a,J=z,Y=function(t){return J(t)?t:void 0},K=function(t,e){return arguments.length<2?Y(q[t]):q[t]&&q[t][e]},U=j({}.isPrototypeOf),X=K("navigator","userAgent")||"",H=a,Q=X,V=H.process,$=H.Deno,Z=V&&V.versions||$&&$.version,tt=Z&&Z.v8;tt&&(g=(y=tt.split("."))[0]>0&&y[0]<4?1:+(y[0]+y[1])),!g&&Q&&(!(y=Q.match(/Edge\/(\d+)/))||y[1]>=74)&&(y=Q.match(/Chrome\/(\d+)/))&&(g=+y[1]);var et=g,nt=et,rt=c,it=!!Object.getOwnPropertySymbols&&!rt((function(){var t=Symbol();return!String(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&nt&&nt<41})),ot=it&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,st=K,at=z,ut=U,ct=ot,lt=a.Object,ft=ct?function(t){return"symbol"==typeof t}:function(t){var e=st("Symbol");return at(e)&&ut(e.prototype,lt(t))},ht=a.String,pt=z,dt=function(t){try{return ht(t)}catch(t){return"Object"}},vt=a.TypeError,bt=function(t){if(pt(t))return t;throw vt(dt(t)+" is not a function")},yt=bt,gt=h,mt=z,wt=R,St=a.TypeError,Tt={exports:{}},Ot=a,jt=Object.defineProperty,Mt=function(t,e){try{jt(Ot,t,{value:e,configurable:!0,writable:!0})}catch(n){Ot[t]=e}return e},xt=Mt,kt="__core-js_shared__",Et=a[kt]||xt(kt,{}),Pt=Et;(Tt.exports=function(t,e){return Pt[t]||(Pt[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.20.2",mode:"global",copyright:"Â© 2022 Denis Pushkarev (zloirock.ru)"});var At=L,Ct=a.Object,_t=function(t){return Ct(At(t))},It=_t,Ft=j({}.hasOwnProperty),Dt=Object.hasOwn||function(t,e){return Ft(It(t),e)},Lt=j,Nt=0,Gt=Math.random(),Wt=Lt(1..toString),zt=function(t){return"Symbol("+(void 0===t?"":t)+")_"+Wt(++Nt+Gt,36)},Bt=a,Rt=Tt.exports,qt=Dt,Jt=zt,Yt=it,Kt=ot,Ut=Rt("wks"),Xt=Bt.Symbol,Ht=Xt&&Xt.for,Qt=Kt?Xt:Xt&&Xt.withoutSetter||Jt,Vt=function(t){if(!qt(Ut,t)||!Yt&&"string"!=typeof Ut[t]){var e="Symbol."+t;Yt&&qt(Xt,t)?Ut[t]=Xt[t]:Ut[t]=Kt&&Ht?Ht(e):Qt(e)}return Ut[t]},$t=h,Zt=R,te=ft,ee=function(t,e){var n=t[e];return null==n?void 0:yt(n)},ne=function(t,e){var n,r;if("string"===e&&mt(n=t.toString)&&!wt(r=gt(n,t)))return r;if(mt(n=t.valueOf)&&!wt(r=gt(n,t)))return r;if("string"!==e&&mt(n=t.toString)&&!wt(r=gt(n,t)))return r;throw St("Can't convert object to primitive value")},re=Vt,ie=a.TypeError,oe=re("toPrimitive"),se=function(t,e){if(!Zt(t)||te(t))return t;var n,r=ee(t,oe);if(r){if(void 0===e&&(e="default"),n=$t(r,t,e),!Zt(n)||te(n))return n;throw ie("Can't convert object to primitive value")}return void 0===e&&(e="number"),ne(t,e)},ae=ft,ue=function(t){var e=se(t,"string");return ae(e)?e:e+""},ce=R,le=a.document,fe=ce(le)&&ce(le.createElement),he=function(t){return fe?le.createElement(t):{}},pe=!l&&!c((function(){return 7!=Object.defineProperty(he("div"),"a",{get:function(){return 7}}).a})),de=l,ve=h,be=p,ye=m,ge=W,me=ue,we=Dt,Se=pe,Te=Object.getOwnPropertyDescriptor;u.f=de?Te:function(t,e){if(t=ge(t),e=me(e),Se)try{return Te(t,e)}catch(t){}if(we(t,e))return ye(!ve(be.f,t,e),t[e])};var Oe={},je=l&&c((function(){return 42!=Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype})),Me=a,xe=R,ke=Me.String,Ee=Me.TypeError,Pe=function(t){if(xe(t))return t;throw Ee(ke(t)+" is not an object")},Ae=l,Ce=pe,_e=je,Ie=Pe,Fe=ue,De=a.TypeError,Le=Object.defineProperty,Ne=Object.getOwnPropertyDescriptor,Ge="enumerable",We="configurable",ze="writable";Oe.f=Ae?_e?function(t,e,n){if(Ie(t),e=Fe(e),Ie(n),"function"==typeof t&&"prototype"===e&&"value"in n&&ze in n&&!n.writable){var r=Ne(t,e);r&&r.writable&&(t[e]=n.value,n={configurable:We in n?n.configurable:r.configurable,enumerable:Ge in n?n.enumerable:r.enumerable,writable:!1})}return Le(t,e,n)}:Le:function(t,e,n){if(Ie(t),e=Fe(e),Ie(n),Ce)try{return Le(t,e,n)}catch(t){}if("get"in n||"set"in n)throw De("Accessors not supported");return"value"in n&&(t[e]=n.value),t};var Be=Oe,Re=m,qe=l?function(t,e,n){return Be.f(t,e,Re(1,n))}:function(t,e,n){return t[e]=n,t},Je={exports:{}},Ye=z,Ke=Et,Ue=j(Function.toString);Ye(Ke.inspectSource)||(Ke.inspectSource=function(t){return Ue(t)});var Xe,He,Qe,Ve=Ke.inspectSource,$e=z,Ze=Ve,tn=a.WeakMap,en=$e(tn)&&/native code/.test(Ze(tn)),nn=Tt.exports,rn=zt,on=nn("keys"),sn={},an=en,un=a,cn=j,ln=R,fn=qe,hn=Dt,pn=Et,dn=function(t){return on[t]||(on[t]=rn(t))},vn=sn,bn="Object already initialized",yn=un.TypeError,gn=un.WeakMap;if(an||pn.state){var mn=pn.state||(pn.state=new gn),wn=cn(mn.get),Sn=cn(mn.has),Tn=cn(mn.set);Xe=function(t,e){if(Sn(mn,t))throw new yn(bn);return e.facade=t,Tn(mn,t,e),e},He=function(t){return wn(mn,t)||{}},Qe=function(t){return Sn(mn,t)}}else{var On=dn("state");vn[On]=!0,Xe=function(t,e){if(hn(t,On))throw new yn(bn);return e.facade=t,fn(t,On,e),e},He=function(t){return hn(t,On)?t[On]:{}},Qe=function(t){return hn(t,On)}}var jn={set:Xe,get:He,has:Qe,enforce:function(t){return Qe(t)?He(t):Xe(t,{})},getterFor:function(t){return function(e){var n;if(!ln(e)||(n=He(e)).type!==t)throw yn("Incompatible receiver, "+t+" required");return n}}},Mn=l,xn=Dt,kn=Function.prototype,En=Mn&&Object.getOwnPropertyDescriptor,Pn=xn(kn,"name"),An=Pn&&"something"===function(){}.name,Cn=Pn&&(!Mn||Mn&&En(kn,"name").configurable),_n=a,In=z,Fn=Dt,Dn=qe,Ln=Mt,Nn=Ve,Gn={EXISTS:Pn,PROPER:An,CONFIGURABLE:Cn}.CONFIGURABLE,Wn=jn.get,zn=jn.enforce,Bn=String(String).split("String");(Je.exports=function(t,e,n,r){var i,o=!!r&&!!r.unsafe,s=!!r&&!!r.enumerable,a=!!r&&!!r.noTargetGet,u=r&&void 0!==r.name?r.name:e;In(n)&&("Symbol("===String(u).slice(0,7)&&(u="["+String(u).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),(!Fn(n,"name")||Gn&&n.name!==u)&&Dn(n,"name",u),(i=zn(n)).source||(i.source=Bn.join("string"==typeof u?u:""))),t!==_n?(o?!a&&t[e]&&(s=!0):delete t[e],s?t[e]=n:Dn(t,e,n)):s?t[e]=n:Ln(e,n)})(Function.prototype,"toString",(function(){return In(this)&&Wn(this).source||Nn(this)}));var Rn={},qn=Math.ceil,Jn=Math.floor,Yn=function(t){var e=+t;return e!=e||0===e?0:(e>0?Jn:qn)(e)},Kn=Yn,Un=Math.max,Xn=Math.min,Hn=function(t,e){var n=Kn(t);return n<0?Un(n+e,0):Xn(n,e)},Qn=Yn,Vn=Math.min,$n=function(t){return t>0?Vn(Qn(t),9007199254740991):0},Zn=function(t){return $n(t.length)},tr=W,er=Hn,nr=Zn,rr=function(t){return function(e,n,r){var i,o=tr(e),s=nr(o),a=er(r,s);if(t&&n!=n){for(;s>a;)if((i=o[a++])!=i)return!0}else for(;s>a;a++)if((t||a in o)&&o[a]===n)return t||a||0;return!t&&-1}},ir={includes:rr(!0),indexOf:rr(!1)},or=Dt,sr=W,ar=ir.indexOf,ur=sn,cr=j([].push),lr=function(t,e){var n,r=sr(t),i=0,o=[];for(n in r)!or(ur,n)&&or(r,n)&&cr(o,n);for(;e.length>i;)or(r,n=e[i++])&&(~ar(o,n)||cr(o,n));return o},fr=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],hr=lr,pr=fr.concat("length","prototype");Rn.f=Object.getOwnPropertyNames||function(t){return hr(t,pr)};var dr={};dr.f=Object.getOwnPropertySymbols;var vr=K,br=Rn,yr=dr,gr=Pe,mr=j([].concat),wr=vr("Reflect","ownKeys")||function(t){var e=br.f(gr(t)),n=yr.f;return n?mr(e,n(t)):e},Sr=Dt,Tr=wr,Or=u,jr=Oe,Mr=c,xr=z,kr=/#|\.prototype\./,Er=function(t,e){var n=Ar[Pr(t)];return n==_r||n!=Cr&&(xr(e)?Mr(e):!!e)},Pr=Er.normalize=function(t){return String(t).replace(kr,".").toLowerCase()},Ar=Er.data={},Cr=Er.NATIVE="N",_r=Er.POLYFILL="P",Ir=Er,Fr=a,Dr=u.f,Lr=qe,Nr=Je.exports,Gr=Mt,Wr=function(t,e,n){for(var r=Tr(e),i=jr.f,o=Or.f,s=0;s<r.length;s++){var a=r[s];Sr(t,a)||n&&Sr(n,a)||i(t,a,o(e,a))}},zr=Ir,Br=function(t,e){var n,r,i,o,s,a=t.target,u=t.global,c=t.stat;if(n=u?Fr:c?Fr[a]||Gr(a,{}):(Fr[a]||{}).prototype)for(r in e){if(o=e[r],i=t.noTargetGet?(s=Dr(n,r))&&s.value:n[r],!zr(u?r:a+(c?".":"#")+r,t.forced)&&void 0!==i){if(typeof o==typeof i)continue;Wr(o,i)}(t.sham||i&&i.sham)&&Lr(o,"sham",!0),Nr(n,r,o,t)}},Rr={};Rr[Vt("toStringTag")]="z";var qr=a,Jr="[object z]"===String(Rr),Yr=z,Kr=E,Ur=Vt("toStringTag"),Xr=qr.Object,Hr="Arguments"==Kr(function(){return arguments}()),Qr=Jr?Kr:function(t){var e,n,r;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=function(t,e){try{return t[e]}catch(t){}}(e=Xr(t),Ur))?n:Hr?Kr(e):"Object"==(r=Kr(e))&&Yr(e.callee)?"Arguments":r},Vr=Qr,$r=a.String,Zr=ue,ti=Oe,ei=m,ni=function(t,e,n){var r=Zr(e);r in t?ti.f(t,r,ei(0,n)):t[r]=n},ri=Hn,ii=Zn,oi=ni,si=a.Array,ai=Math.max,ui=function(t,e,n){for(var r=ii(t),i=ri(e,r),o=ri(void 0===n?r:n,r),s=si(ai(o-i,0)),a=0;i<o;i++,a++)oi(s,a,t[i]);return s.length=a,s},ci=Math.floor,li=function(t,e){var n=t.length,r=ci(n/2);return n<8?fi(t,e):hi(t,li(ui(t,0,r),e),li(ui(t,r),e),e)},fi=function(t,e){for(var n,r,i=t.length,o=1;o<i;){for(r=o,n=t[o];r&&e(t[r-1],n)>0;)t[r]=t[--r];r!==o++&&(t[r]=n)}return t},hi=function(t,e,n,r){for(var i=e.length,o=n.length,s=0,a=0;s<i||a<o;)t[s+a]=s<i&&a<o?r(e[s],n[a])<=0?e[s++]:n[a++]:s<i?e[s++]:n[a++];return t},pi=li,di=c,vi=X.match(/firefox\/(\d+)/i),bi=!!vi&&+vi[1],yi=/MSIE|Trident/.test(X),gi=X.match(/AppleWebKit\/(\d+)\./),mi=!!gi&&+gi[1],wi=Br,Si=j,Ti=bt,Oi=_t,ji=Zn,Mi=function(t){if("Symbol"===Vr(t))throw TypeError("Cannot convert a Symbol value to a string");return $r(t)},xi=c,ki=pi,Ei=function(t,e){var n=[][t];return!!n&&di((function(){n.call(null,e||function(){throw 1},1)}))},Pi=bi,Ai=yi,Ci=et,_i=mi,Ii=[],Fi=Si(Ii.sort),Di=Si(Ii.push),Li=xi((function(){Ii.sort(void 0)})),Ni=xi((function(){Ii.sort(null)})),Gi=Ei("sort"),Wi=!xi((function(){if(Ci)return Ci<70;if(!(Pi&&Pi>3)){if(Ai)return!0;if(_i)return _i<603;var t,e,n,r,i="";for(t=65;t<76;t++){switch(e=String.fromCharCode(t),t){case 66:case 69:case 70:case 72:n=3;break;case 68:case 71:n=4;break;default:n=2}for(r=0;r<47;r++)Ii.push({k:e+r,v:n})}for(Ii.sort((function(t,e){return e.v-t.v})),r=0;r<Ii.length;r++)e=Ii[r].k.charAt(0),i.charAt(i.length-1)!==e&&(i+=e);return"DGBEFHACIJK"!==i}}));wi({target:"Array",proto:!0,forced:Li||!Ni||!Gi||!Wi},{sort:function(t){void 0!==t&&Ti(t);var e=Oi(this);if(Wi)return void 0===t?Fi(e):Fi(e,t);var n,r,i=[],o=ji(e);for(r=0;r<o;r++)r in e&&Di(i,e[r]);for(ki(i,function(t){return function(e,n){return void 0===n?-1:void 0===e?1:void 0!==t?+t(e,n)||0:Mi(e)>Mi(n)?1:-1}}(t)),n=i.length,r=0;r<n;)e[r]=i[r++];for(;r<o;)delete e[r++];return e}});var zi=lr,Bi=fr,Ri=Object.keys||function(t){return zi(t,Bi)},qi=l,Ji=j,Yi=h,Ki=c,Ui=Ri,Xi=dr,Hi=p,Qi=_t,Vi=F,$i=Object.assign,Zi=Object.defineProperty,to=Ji([].concat),eo=!$i||Ki((function(){if(qi&&1!==$i({b:1},$i(Zi({},"a",{enumerable:!0,get:function(){Zi(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var t={},e={},n=Symbol(),r="abcdefghijklmnopqrst";return t[n]=7,r.split("").forEach((function(t){e[t]=t})),7!=$i({},t)[n]||Ui($i({},e)).join("")!=r}))?function(t,e){for(var n=Qi(t),r=arguments.length,i=1,o=Xi.f,s=Hi.f;r>i;)for(var a,u=Vi(arguments[i++]),c=o?to(Ui(u),o(u)):Ui(u),l=c.length,f=0;l>f;)a=c[f++],qi&&!Yi(s,u,a)||(n[a]=u[a]);return n}:$i,no=eo;Br({target:"Object",stat:!0,forced:Object.assign!==no},{assign:no});var ro=E,io=Array.isArray||function(t){return"Array"==ro(t)},oo=j,so=c,ao=z,uo=Qr,co=Ve,lo=function(){},fo=[],ho=K("Reflect","construct"),po=/^\s*(?:class|function)\b/,vo=oo(po.exec),bo=!po.exec(lo),yo=function(t){if(!ao(t))return!1;try{return ho(lo,fo,t),!0}catch(t){return!1}},go=function(t){if(!ao(t))return!1;switch(uo(t)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return bo||!!vo(po,co(t))}catch(t){return!0}};go.sham=!0;var mo=!ho||so((function(){var t;return yo(yo.call)||!yo(Object)||!yo((function(){t=!0}))||t}))?go:yo,wo=a,So=io,To=mo,Oo=R,jo=Vt("species"),Mo=wo.Array,xo=function(t){var e;return So(t)&&(e=t.constructor,(To(e)&&(e===Mo||So(e.prototype))||Oo(e)&&null===(e=e[jo]))&&(e=void 0)),void 0===e?Mo:e},ko=c,Eo=et,Po=Vt("species"),Ao=Br,Co=a,_o=c,Io=io,Fo=R,Do=_t,Lo=Zn,No=ni,Go=function(t,e){return new(xo(t))(0===e?0:e)},Wo=function(t){return Eo>=51||!ko((function(){var e=[];return(e.constructor={})[Po]=function(){return{foo:1}},1!==e[t](Boolean).foo}))},zo=et,Bo=Vt("isConcatSpreadable"),Ro=9007199254740991,qo="Maximum allowed index exceeded",Jo=Co.TypeError,Yo=zo>=51||!_o((function(){var t=[];return t[Bo]=!1,t.concat()[0]!==t})),Ko=Wo("concat"),Uo=function(t){if(!Fo(t))return!1;var e=t[Bo];return void 0!==e?!!e:Io(t)};Ao({target:"Array",proto:!0,forced:!Yo||!Ko},{concat:function(t){var e,n,r,i,o,s=Do(this),a=Go(s,0),u=0;for(e=-1,r=arguments.length;e<r;e++)if(Uo(o=-1===e?s:arguments[e])){if(u+(i=Lo(o))>Ro)throw Jo(qo);for(n=0;n<i;n++,u++)n in o&&No(a,u,o[n])}else{if(u>=Ro)throw Jo(qo);No(a,u++,o)}return a.length=u,a}});var Xo=new n.default.TimeCapsule,Ho="@donkeyclip/scrollbar_player",Qo=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r(this,t),this.clip=e.clip,this.host=this.clip.props.host,this.swipeAxis="vertical"===(e.swipeAxis||"vertical")?"clientY":"clientX";var i=e.mode||"free";"free"===i?(this.host.onwheel=this.handlePlainWheel.bind(this),this.journey=Xo.startJourney(this.clip),this.host.addEventListener("touchstart",this._touchstart.bind(this)),this.host.addEventListener("touchmove",this._touchmove.bind(this))):"chapters"===i&&(this.transitionTimeout=null,this.transitionSpeed=e.transitionSpeed||1,this.easing=n.default.utils.easings[e.easing||"easeOutQuart"],this.transitionStart=null,e.chapters.sort((function(t,e){return t.millisecond-e.millisecond})),this.chapters=e.chapters,this.transitioning=!1,this.host.onwheel=this.handleChapterWheel.bind(this),this.host.addEventListener("touchstart",this._touchstart.bind(this)),this.host.addEventListener("touchmove",this._touchmove.bind(this)),this.host.addEventListener("touchend",this._chapterTouchend.bind(this)));var o=5/(e.wheelSpeed||5);this.speed=1/o;var s={display:!0,position:"right",color:"purple"};void 0!==e.progressBar&&Object.assign(s,e.progressBar),this._setupScrollbar(s)}var e,o,s;return e=t,(o=[{key:"_setupScrollbar",value:function(t){var e=this;if(!1!==t.display){var n,r,i=document.createElement("div");switch(i.setAttribute("id","".concat(Ho,"-scrollbarId")),t.position){case"left":n="left:0px; top: 0px; width: 2px; height: 0%;",r="height";break;case"right":n="right:0px; top: 0px; width: 2px; height: 0%;",r="height";break;case"top":n="top:0px; left: 0px; height: 2px; width: 0%;",r="width";break;case"bottom":n="bottom:0px; left: 0px; height: 2px; width: 0%;",r="width"}i.setAttribute("style","".concat(n," position:absolute; background: ").concat(t.color,";")),this.host.appendChild(i),this.clip.subscribe("".concat(Ho,"_").concat((new Date).getTime()),(function(t){i.style[r]="".concat(100*t/e.clip.duration,"%")}))}}},{key:"_touchstart",value:function(t){t.preventDefault(),1===t.touches.length&&(this.previousTouch=t.touches[0][this.swipeAxis],this.transitioning=!1)}},{key:"_touchmove",value:function(t){t.preventDefault(),this.transitioning=!1,null!==this.transitionTimeout&&clearTimeout(this.transitionTimeout);var e=this.previousTouch-event.touches[0][this.swipeAxis];this.direction=e>0?"fw":"bw",this.previousTouch=event.touches[0][this.swipeAxis];var n=10*e*this.speed,r=Xo.startJourney(this.clip),i=this.clip.runTimeInfo.currentMillisecond+n;i<0?(i=0,n=0):i>this.clip.duration&&(i=this.clip.duration,n=0),r.destination(i)}},{key:"_chapterTouchend",value:function(t){var e=this;if(t.preventDefault(),"fw"===this.direction&&this.clip.runTimeInfo.currentMillisecond!==this.clip.duration){var n=this._getNextChapter(this.clip.runTimeInfo.currentMillisecond);this.transitionTimeout=setTimeout((function(){e.transitionToChapter(n,"fw")}),this.latency)}else if("bw"===this.direction&&0!==this.clip.runTimeInfo.currentMillisecond){var r=this._getPreviousChapter(this.clip.runTimeInfo.currentMillisecond);this.transitionTimeout=setTimeout((function(){e.transitionToChapter(r,"bw")}),this.latency)}}},{key:"_getNextChapter",value:function(t){for(var e=0;e<this.chapters.length;e++){var n=this.chapters[e];if(n.millisecond>t)return n.millisecond}return this.clip.duration}},{key:"_getPreviousChapter",value:function(t){for(var e=this.chapters.length-1;e>=0;e--){var n=this.chapters[e];if(n.millisecond<t)return n.millisecond}return 0}},{key:"handleChapterWheel",value:function(t){var e=this;t.preventDefault(),this.transitioning=!1,null!==this.transitionTimeout&&clearTimeout(this.transitionTimeout);var n=t.deltaY*this.speed,r=Xo.startJourney(this.clip),i=this.clip.runTimeInfo.currentMillisecond+n;if(i<0?(i=0,n=0):i>this.clip.duration&&(i=this.clip.duration,n=0),n>0){var o=this._getNextChapter(i);this.transitionTimeout=setTimeout((function(){e.transitionToChapter(o,"fw")}),this.latency)}else if(n<0){var s=this._getPreviousChapter(i);this.transitionTimeout=setTimeout((function(){e.transitionToChapter(s,"bw")}),this.latency)}r.destination(i)}},{key:"transitionToChapter",value:function(t){this.transitioning=!0,this.transitionStart=null,this.targetMillisecond=t,this.startMillisecond=this.clip.runTimeInfo.currentMillisecond,this.journey=Xo.startJourney(this.clip),this.direction=this.targetMillisecond>=this.startMillisecond?"fw":"bw",window.requestAnimationFrame(this._step.bind(this))}},{key:"_step",value:function(t){null===this.transitionStart&&(this.transitionStart=t);var e,n=t-this.transitionStart,r=!1;if("fw"===this.direction?(e=this.startMillisecond+n*this.transitionSpeed)>this.targetMillisecond&&(e=this.targetMillisecond,r=!0):(e=this.startMillisecond-n*this.transitionSpeed)<this.targetMillisecond&&(e=this.targetMillisecond,r=!0),!1!==this.transitioning){var i,o=Math.abs(e-this.startMillisecond)/Math.abs(this.targetMillisecond-this.startMillisecond);i="fw"===this.direction?this.startMillisecond+this.easing(o)*(this.targetMillisecond-this.startMillisecond):this.startMillisecond-this.easing(o)*(this.startMillisecond-this.targetMillisecond),this.journey.station(i),r?this.journey.destination():window.requestAnimationFrame(this._step.bind(this))}}},{key:"handlePlainWheel",value:function(t){t.preventDefault();var e=t.deltaY*this.speed,n=this.clip.runTimeInfo.currentMillisecond+e;n<0?n=0:n>this.clip.duration&&(n=this.clip.duration),this.journey.station(n)}}])&&i(e.prototype,o),s&&i(e,s),Object.defineProperty(e,"prototype",{writable:!1}),t}();return Qo}));
